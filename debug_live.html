<!DOCTYPE html>\n<html>\n<head>\n    <title>üîç Debug Live - Sistema de Categor√≠as</title>\n    <link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css\" rel=\"stylesheet\">\n    <style>\n        body { padding: 20px; font-family: 'Courier New', monospace; }\n        .debug-section { \n            background: #f8f9fa; \n            border: 1px solid #dee2e6; \n            border-radius: 5px; \n            padding: 15px; \n            margin: 10px 0; \n        }\n        .console-output {\n            background: #000;\n            color: #0f0;\n            padding: 15px;\n            border-radius: 5px;\n            max-height: 400px;\n            overflow-y: auto;\n            font-family: 'Courier New', monospace;\n            font-size: 12px;\n        }\n        .test-btn { margin: 5px; }\n        .status-ok { color: #28a745; font-weight: bold; }\n        .status-error { color: #dc3545; font-weight: bold; }\n        .status-warning { color: #ffc107; font-weight: bold; }\n    </style>\n</head>\n<body>\n    <div class=\"container-fluid\">\n        <h1>üîç DEBUG LIVE - Sistema de Categor√≠as</h1>\n        <p class=\"text-muted\">Diagn√≥stico en tiempo real del sistema</p>\n        \n        <div class=\"row\">\n            <div class=\"col-md-6\">\n                <div class=\"debug-section\">\n                    <h3>üìÅ 1. Verificaci√≥n de Archivos</h3>\n                    <div id=\"file-status\">Verificando...</div>\n                    <button class=\"btn btn-primary test-btn\" onclick=\"checkFiles()\">üîÑ Verificar Archivos</button>\n                </div>\n                \n                <div class=\"debug-section\">\n                    <h3>üîß 2. Funciones JavaScript</h3>\n                    <div id=\"function-status\">Verificando...</div>\n                    <button class=\"btn btn-info test-btn\" onclick=\"checkFunctions()\">üîÑ Verificar Funciones</button>\n                </div>\n                \n                <div class=\"debug-section\">\n                    <h3>üéØ 3. Test de Botones</h3>\n                    <button class=\"btn btn-success test-btn\" onclick=\"testEditarTrabajo()\">Test Editar Trabajo</button>\n                    <button class=\"btn btn-warning test-btn\" onclick=\"testConfirmacion()\">Test Confirmaci√≥n</button>\n                    <button class=\"btn btn-danger test-btn\" onclick=\"testLimpiarModales()\">Test Limpiar Modales</button>\n                </div>\n            </div>\n            \n            <div class=\"col-md-6\">\n                <div class=\"debug-section\">\n                    <h3>üñ•Ô∏è Console Output</h3>\n                    <div id=\"console-output\" class=\"console-output\">\n                        === ESPERANDO LOGS ===\\n\n                    </div>\n                    <button class=\"btn btn-secondary\" onclick=\"clearConsole()\">üßπ Limpiar Console</button>\n                </div>\n            </div>\n        </div>\n        \n        <div class=\"debug-section\">\n            <h3>üö® 4. Tests de Emergencia</h3>\n            <div class=\"row\">\n                <div class=\"col-md-3\">\n                    <button class=\"btn btn-outline-primary\" onclick=\"forceReloadScripts()\">üîÑ Recargar Scripts</button>\n                </div>\n                <div class=\"col-md-3\">\n                    <button class=\"btn btn-outline-warning\" onclick=\"clearAllCache()\">üßπ Limpiar Cache</button>\n                </div>\n                <div class=\"col-md-3\">\n                    <button class=\"btn btn-outline-danger\" onclick=\"emergencyCleanup()\">üöë Limpieza Emergencia</button>\n                </div>\n                <div class=\"col-md-3\">\n                    <button class=\"btn btn-outline-info\" onclick=\"fullDiagnostic()\">üîç Diagn√≥stico Completo</button>\n                </div>\n            </div>\n        </div>\n        \n        <!-- Botones de prueba reales -->\n        <div class=\"debug-section\">\n            <h3>üéØ 5. Botones Reales de Prueba</h3>\n            <button class=\"btn btn-primary btn-editar-categoria\"\n                    data-categoria-id=\"999\"\n                    data-categoria-nombre=\"TEST Trabajo\"\n                    data-categoria-descripcion=\"Descripci√≥n de prueba\"\n                    data-categoria-padre=\"\"\n                    data-categoria-complejidad=\"2\"\n                    data-categoria-activo=\"true\"\n                    data-tipo=\"trabajo\">\n                <i class=\"fas fa-edit\"></i> TEST: Editar Trabajo\n            </button>\n            \n            <button class=\"btn btn-warning btn-toggle-categoria\"\n                    data-categoria-id=\"999\"\n                    data-tipo=\"trabajo\"\n                    data-categoria-activo=\"true\">\n                <i class=\"fas fa-power-off\"></i> TEST: Toggle Trabajo\n            </button>\n        </div>\n    </div>\n    \n    <!-- Modal de prueba -->\n    <div class=\"modal fade\" id=\"modalEditarCategoria\" tabindex=\"-1\">\n        <div class=\"modal-dialog\">\n            <div class=\"modal-content\">\n                <div class=\"modal-header\">\n                    <h5 class=\"modal-title\">TEST: Editar Categor√≠a</h5>\n                    <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\"></button>\n                </div>\n                <div class=\"modal-body\">\n                    <input type=\"hidden\" id=\"editCategoriaId\">\n                    <input type=\"hidden\" id=\"editTipoCategoria\">\n                    <div class=\"mb-3\">\n                        <label class=\"form-label\">Nombre</label>\n                        <input type=\"text\" class=\"form-control\" id=\"editNombreCategoria\">\n                    </div>\n                    <div class=\"mb-3\">\n                        <label class=\"form-label\">Descripci√≥n</label>\n                        <textarea class=\"form-control\" id=\"editDescripcionCategoria\"></textarea>\n                    </div>\n                    <div class=\"mb-3\">\n                        <label class=\"form-label\">Categor√≠a Padre</label>\n                        <select class=\"form-control\" id=\"editCategoriaPadre\">\n                            <option value=\"\">Sin padre</option>\n                        </select>\n                    </div>\n                    <div class=\"mb-3\" id=\"editComplejidadContainer\">\n                        <label class=\"form-label\">Complejidad</label>\n                        <select class=\"form-control\" id=\"editComplejidadCategoria\">\n                            <option value=\"1\">B√°sica</option>\n                            <option value=\"2\">Intermedia</option>\n                            <option value=\"3\">Avanzada</option>\n                        </select>\n                    </div>\n                    <div class=\"mb-3\">\n                        <div class=\"form-check\">\n                            <input type=\"checkbox\" class=\"form-check-input\" id=\"editActivoCategoria\">\n                            <label class=\"form-check-label\">Activo</label>\n                        </div>\n                    </div>\n                </div>\n                <div class=\"modal-footer\">\n                    <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">Cancelar</button>\n                    <button type=\"button\" class=\"btn btn-primary\">Guardar (TEST)</button>\n                </div>\n            </div>\n        </div>\n    </div>\n    \n    <!-- Scripts -->\n    <script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js\"></script>\n    <script>\n        // Capturar logs de consola\n        const originalLog = console.log;\n        const originalError = console.error;\n        const originalWarn = console.warn;\n        \n        function addToConsole(message, type = 'log') {\n            const consoleOutput = document.getElementById('console-output');\n            const timestamp = new Date().toLocaleTimeString();\n            const prefix = {\n                'log': '[LOG]',\n                'error': '[ERROR]',\n                'warn': '[WARN]'\n            }[type] || '[LOG]';\n            \n            consoleOutput.innerHTML += `[${timestamp}] ${prefix} ${message}\\n`;\n            consoleOutput.scrollTop = consoleOutput.scrollHeight;\n        }\n        \n        console.log = function(...args) {\n            originalLog.apply(console, args);\n            addToConsole(args.join(' '), 'log');\n        };\n        \n        console.error = function(...args) {\n            originalError.apply(console, args);\n            addToConsole(args.join(' '), 'error');\n        };\n        \n        console.warn = function(...args) {\n            originalWarn.apply(console, args);\n            addToConsole(args.join(' '), 'warn');\n        };\n        \n        // Funciones de test\n        function checkFiles() {\n            const statusDiv = document.getElementById('file-status');\n            let html = '<ul>';\n            \n            const scripts = document.querySelectorAll('script[src]');\n            scripts.forEach(script => {\n                const src = script.src;\n                if (src.includes('notifications.js') || src.includes('gestion-categorias.js') || src.includes('universal-fixes.js')) {\n                    html += `<li class=\"status-ok\">‚úÖ ${src.split('/').pop()}</li>`;\n                }\n            });\n            html += '</ul>';\n            statusDiv.innerHTML = html;\n            \n            console.log('üîç Verificaci√≥n de archivos completada');\n        }\n        \n        function checkFunctions() {\n            const statusDiv = document.getElementById('function-status');\n            const functions = [\n                'editarCategoriaTrabajo',\n                'eliminarCategoriaTrabajo',\n                'verPalabrasCategoria',\n                'toggleCategoriaEstado',\n                'showSuccess',\n                'showError',\n                'showConfirm',\n                'limpiarModalesBloqueados'\n            ];\n            \n            let html = '<ul>';\n            functions.forEach(func => {\n                const exists = typeof window[func] === 'function';\n                const status = exists ? 'status-ok' : 'status-error';\n                const icon = exists ? '‚úÖ' : '‚ùå';\n                html += `<li class=\"${status}\">${icon} ${func}</li>`;\n                console.log(`${icon} Funci√≥n ${func}: ${exists ? 'EXISTS' : 'MISSING'}`);\n            });\n            html += '</ul>';\n            statusDiv.innerHTML = html;\n        }\n        \n        function testEditarTrabajo() {\n            console.log('üß™ TEST: Intentando ejecutar editarCategoriaTrabajo...');\n            if (typeof editarCategoriaTrabajo === 'function') {\n                try {\n                    editarCategoriaTrabajo(999, 'TEST Trabajo', 'Desc test', '', 2, true);\n                    console.log('‚úÖ TEST: editarCategoriaTrabajo ejecutado');\n                } catch (error) {\n                    console.error('‚ùå TEST: Error en editarCategoriaTrabajo:', error);\n                }\n            } else {\n                console.error('‚ùå TEST: editarCategoriaTrabajo no existe');\n            }\n        }\n        \n        function testConfirmacion() {\n            console.log('üß™ TEST: Intentando ejecutar showConfirm...');\n            if (typeof showConfirm === 'function') {\n                showConfirm('¬øEsto es una prueba?', function(result) {\n                    console.log('‚úÖ TEST: showConfirm resultado:', result);\n                });\n            } else {\n                console.error('‚ùå TEST: showConfirm no existe');\n            }\n        }\n        \n        function testLimpiarModales() {\n            console.log('üß™ TEST: Intentando ejecutar limpiarModalesBloqueados...');\n            if (typeof limpiarModalesBloqueados === 'function') {\n                limpiarModalesBloqueados();\n                console.log('‚úÖ TEST: limpiarModalesBloqueados ejecutado');\n            } else {\n                console.error('‚ùå TEST: limpiarModalesBloqueados no existe');\n            }\n        }\n        \n        function clearConsole() {\n            document.getElementById('console-output').innerHTML = '=== CONSOLE LIMPIADO ===\\n';\n        }\n        \n        function forceReloadScripts() {\n            console.log('üîÑ Forzando recarga de scripts...');\n            location.reload(true);\n        }\n        \n        function clearAllCache() {\n            console.log('üßπ Limpiando cache...');\n            if ('caches' in window) {\n                caches.keys().then(names => {\n                    names.forEach(name => {\n                        caches.delete(name);\n                    });\n                });\n            }\n            localStorage.clear();\n            sessionStorage.clear();\n            console.log('‚úÖ Cache limpiado');\n        }\n        \n        function emergencyCleanup() {\n            console.log('üöë Limpieza de emergencia...');\n            \n            // Limpiar modales\n            document.querySelectorAll('.modal').forEach(modal => {\n                modal.style.display = 'none';\n                modal.classList.remove('show');\n            });\n            \n            // Limpiar backdrop\n            document.querySelectorAll('.modal-backdrop').forEach(backdrop => {\n                backdrop.remove();\n            });\n            \n            // Limpiar body\n            document.body.classList.remove('modal-open');\n            document.body.style.removeProperty('padding-right');\n            document.body.style.removeProperty('overflow');\n            \n            console.log('‚úÖ Limpieza de emergencia completada');\n        }\n        \n        function fullDiagnostic() {\n            console.log('üîç === DIAGN√ìSTICO COMPLETO ===');\n            checkFiles();\n            setTimeout(() => {\n                checkFunctions();\n                console.log('üîç Verificando event listeners...');\n                \n                const editButtons = document.querySelectorAll('.btn-editar-categoria');\n                console.log(`üìù Botones .btn-editar-categoria encontrados: ${editButtons.length}`);\n                \n                editButtons.forEach((btn, index) => {\n                    console.log(`Bot√≥n ${index + 1}: tipo=${btn.dataset.tipo}, id=${btn.dataset.categoriaId}`);\n                });\n                \n                console.log('üîç === DIAGN√ìSTICO COMPLETADO ===');\n            }, 1000);\n        }\n        \n        // Auto-start\n        window.onload = function() {\n            console.log('üîç === DEBUG LIVE INICIADO ===');\n            console.log('Esperando 2 segundos para cargar scripts...');\n            \n            setTimeout(() => {\n                fullDiagnostic();\n            }, 2000);\n        };\n    </script>\n    \n    <!-- Cargar scripts del sistema -->\n    <script src=\"/static/js/notifications.js?v=debug-live\"></script>\n    <script src=\"/static/js/universal-fixes.js?v=debug-live\"></script>\n    <script src=\"/static/js/gestion-categorias.js?v=debug-live\"></script>\n</body>\n</html>"
